@using Maddalena.Core.Blog.Models
@using Maddalena.Core.Blog.Services
@model Maddalena.Core.Blog.Models.Post
@inject IBlogSettings settings
@{
    ViewData["Title"] = Model.Title;
    ViewData["Description"] = Model.Excerpt;
    bool showFullPost = ViewContext.RouteData.Values.ContainsKey("slug");
    string host = Context.Request.Scheme + "://" + Context.Request.Host;
    bool isCodePreview = Model.Content.Contains("</code>");
}

@section Head {
    <link rel="canonical" href="@(host + Model.GetLink())" />
}

    <section>
      <article class="post container" itemscope itemtype="http://schema.org/BlogPosting" itemprop="blogPost">
        <div class="row">
          <div class="col-10">
            <h1 itemprop="name headline">
              @Model.Title
            </h1>
          </div>
          <div class="col-2">
            <time datetime="@Model.PubDate.ToString("s")" itemprop="datePublished">
              @Model.PubDate.ToString("MMM d, yyyy")
            </time>

            @if (User.Identity.IsAuthenticated && User.IsInRole("blog"))
            {
              <a asp-controller="Blog" asp-action="edit" asp-route-id="@Model.Id" title="Edit the post">Edit post</a>
            }
          </div>
        </div>

        <div class="row">
          <div class="col-12">
            <div itemprop="articleBody mainEntityOfPage" cdnify>
              @Html.Raw(Model.RenderContent())
            </div>
          </div>
        </div>

        <div class="row">
          <div class="col-12">
            <footer>
              <meta itemprop="author" content="@settings.Owner" />
              <meta itemprop="dateModified" content="@Model.LastModified.ToString("s")" />
              <meta itemprop="mainEntityOfPage" content="@(host + Model.GetLink())" />
            </footer>
          </div>
        </div>
      </article>
    </section>
